## 软件安全作业1

### 编写思路详述

因为该函数需要能够识别多种错误并对它们做出响应，所以我首先想到了利用语言标准库里自带的异常处理函数

经过查询，C语言的`setjmp.h`标准库实现了在识别到异常后跳转到特定函数内部特定位置的功能。具体实现方法是用`setjmp`方法设置跳转点，在识别到异常后调用`longjmp`方法跳转到跳转点。

但是由于在字符串拷贝过程中的不安全操作通常不会导致程序无法继续执行，并且有些还可以修复（比如截断操作，可以通过扩大复制目的地的空间达成），但是`longjmp`方法实现的并不是调用而是跳转，所以并不能够在修复后跳转回异常出现的地方继续执行，如果使用的话会造成代码模块化程度下降。

所以这次作业我借鉴了该标准库的思路，单独设置了异常处理函数，但是采用的是识别到特定种类的异常后通过函数调用转移到异常处理函数

### 错误识别和处理

#### 无界字符串复制和空结尾错误

通过设置一个最长复制长度的参数，可以实现在源字符串过长时，即有可能出现空结尾错误时，主动停止复制并向程序员报告错误

#### 截断错误

复制函数会计算源字符串长度，并与目的空间大小进行比对，当目的空间太小时，也会尝试给目的空间重新分配合适的大小，如果分配失败，则报告用户

### 运行截图

#### 截断错误

![image-20220929123132667](https://raw.githubusercontent.com/Goplush/BlogImg/main/img/202209291231816.png)

#### 无界字符串复制和空结尾错误

为了方便测试，设置最长复制长度为1

![image-20220929123533116](https://raw.githubusercontent.com/Goplush/BlogImg/main/img/202209291235155.png)